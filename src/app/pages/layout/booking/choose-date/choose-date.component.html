<div class="w-full bg-popover rounded-3xl px-8 pb-6 mt-5">
  <h2
    class="text-muted-foreground font-medium text-base border-b border-border py-6"
  >
    Elige fecha y hora
  </h2>

  @if (doctorId) { @if (!loading) {
  <div class="flex justify-center gap-3 pt-6">
    @for (avaliableDate of availableDates; track $index) {
    <button
      type="button"
      class="p-[14px] w-14 text-sm border text-foreground bg-card rounded-xl font-semibold disabled:opacity-50"
      (click)="onDateSelected(avaliableDate.date, $index)"
      [ngClass]="selectedDay === $index ? 'border-primary' : 'border-transparent'"
    >
      <div class="flex flex-col items-center justify-center">
        <span class="text-muted-foreground text-sm">{{
          avaliableDate.date | date : "E"
        }}</span>
        <span class="text-foreground text-xl font-semibold">{{
          avaliableDate.date | date : "dd"
        }}</span>
      </div>
    </button>
    }
  </div>

  <div class="flex justify-center gap-3 my-8">
    @for (time of availableDates[selectedDay]?.timeSlots; track $index) {
    <button
      type="button"
      class="px-4 py-3 text-sm border text-foreground bg-card rounded-full font-medium flex flex-col items-center justify-center gap-2 disabled:opacity-50"
      (click)="onHourSelected(time, $index)"
      [ngClass]="hourIndex === $index ? 'border-primary' : 'border-transparent'"
    >
      {{ time | date : "h:mm aa" }}
    </button>
    }
  </div>
  } @else {
  <div class="flex justify-center py-24">
    <hlm-icon size="base" name="lucideLoader2" class="animate-spin" />
  </div>
  } } @else {
  <div class="text-center text-sm text-foreground font-medium py-24">
    Elige un doctor
  </div>
  }

  <div
    class="w-[700px] h-14 border rounded-xl bg-input flex items-center justify-between pl-6 mx-auto"
    [ngClass]="buttonState ? 'border-[#93996c]' : 'border-primary'"
  >
    <div class="w-full text-sm font-semibold">
      @if (!buttonState) {
      {{ appointment.date | date : "MMMM d, y" }} |
      <span class="font-medium">{{ appointment.hour | date : "h:mm a" }}</span>
      }
    </div>
    <button
      type="button"
      hlmBtn
      class="rounded-xl px-6"
      [disabled]="buttonState || buttonLoading"
      (click)="onBookAppointment()"
    >
      @if (buttonLoading) {
        <hlm-icon name="lucideLoader2" size="sm" class="mr-2 animate-spin" color="#1f1f1f" />
      }

      Reservar
    </button>
  </div>
</div>
